<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.intellif.vesionbook.srstask.mapper.StreamTaskMapper">
    <sql id="Base_Column_List">
        id, origin_stream, app, unique_id, service, rtmp_output, http_flv_output, hls_output, webrtc_output, status, create_time, update_time
    </sql>

    <!--  <select id="selectByPrimaryKey" resultType="com.intellif.vesionbook.srstask.model.entity.StreamTask" parameterType="java.lang.Long" >-->
    <!--    select-->
    <!--    <include refid="Base_Column_List" />-->
    <!--    from stream_task-->
    <!--    where id = #{id,jdbcType=BIGINT}-->
    <!--  </select>-->

    <!-- 条件筛选 -->
    <select id="selectByParam" resultType="com.intellif.vesionbook.srstask.model.entity.StreamTask"
            parameterType="com.intellif.vesionbook.srstask.model.dto.StreamTaskDto">
        select
        <include refid="Base_Column_List"/>
        from stream_task
        <where>
            <if test="id != null and id != ''">
                and id = #{id,jdbcType=BIGINT}
            </if>
            <if test="originStream != null and originStream != ''">
                and origin_stream = #{originStream,jdbcType=VARCHAR}
            </if>
            <if test="app != null and app != ''">
                and app = #{app,jdbcType=VARCHAR}
            </if>
            <if test="uniqueId != null and uniqueId != ''">
                and unique_id = #{uniqueId,jdbcType=VARCHAR}
            </if>
            <if test="service != null and service != ''">
                and service = #{service,jdbcType=VARCHAR}
            </if>
            <if test="rtmpOutput != null and rtmpOutput != ''">
                and rtmp_output = #{rtmpOutput,jdbcType=VARCHAR}
            </if>
            <if test="httpFlvOutput != null and httpFlvOutput != ''">
                and http_flv_output = #{httpFlvOutput,jdbcType=VARCHAR}
            </if>
            <if test="hlsOutput != null and hlsOutput != ''">
                and hls_output = #{hlsOutput,jdbcType=VARCHAR}
            </if>
            <if test="webrtcOutput != null and webrtcOutput != ''">
                and webrtc_output = #{webrtcOutput,jdbcType=VARCHAR}
            </if>
            <if test="status != null and status != ''">
                and status = #{status,jdbcType=INTEGER}
            </if>
            <if test="createTime != null and createTime != ''">
                and create_time = #{createTime,jdbcType=TIMESTAMP}
            </if>
            <if test="updateTime != null and updateTime != ''">
                and update_time = #{updateTime,jdbcType=TIMESTAMP}
            </if>
        </where>
        <if test="lock == true">
            for update
        </if>

    </select>

    <insert id="insertSelective" parameterType="com.intellif.vesionbook.srstask.model.entity.StreamTask"
            useGeneratedKeys="true" keyProperty="id">
        insert into stream_task
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="originStream != null and originStream != ''">
                origin_stream,
            </if>
            <if test="app != null and app != ''">
                app,
            </if>
            <if test="uniqueId != null and uniqueId != ''">
                unique_id,
            </if>
            <if test="service != null and service != ''">
                service,
            </if>
            <if test="rtmpOutput != null and rtmpOutput != ''">
                rtmp_output,
            </if>
            <if test="httpFlvOutput != null and httpFlvOutput != ''">
                http_flv_output,
            </if>
            <if test="hlsOutput != null and hlsOutput != ''">
                hls_output,
            </if>
            <if test="webrtcOutput != null and webrtcOutput != ''">
                webrtc_output,
            </if>
            <if test="status != null and status != ''">
                status,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="originStream != null and originStream != ''">
                #{originStream,jdbcType=VARCHAR},
            </if>
            <if test="app != null and app != ''">
                #{app,jdbcType=VARCHAR},
            </if>
            <if test="uniqueId != null and uniqueId != ''">
                #{uniqueId,jdbcType=VARCHAR},
            </if>
            <if test="service != null and service != ''">
                #{service,jdbcType=VARCHAR},
            </if>
            <if test="rtmpOutput != null and rtmpOutput != ''">
                #{rtmpOutput,jdbcType=VARCHAR},
            </if>
            <if test="httpFlvOutput != null and httpFlvOutput != ''">
                #{httpFlvOutput,jdbcType=VARCHAR},
            </if>
            <if test="hlsOutput != null and hlsOutput != ''">
                #{hlsOutput,jdbcType=VARCHAR},
            </if>
            <if test="webrtcOutput != null and webrtcOutput != ''">
                #{webrtcOutput,jdbcType=VARCHAR},
            </if>
            <if test="status != null and status != ''">
                #{status,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>

    <update id="updateStatus" parameterType="com.intellif.vesionbook.srstask.model.entity.StreamTask">
        update stream_task
        set status = #{status, jdbcType=INTEGER}
        where app = #{app,jdbcType=VARCHAR}
          and unique_id = #{uniqueId, jdbcType=VARCHAR}
    </update>

</mapper>